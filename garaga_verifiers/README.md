# Garaga Verifiers

Auto-generated Groth16 BN254 verifier contracts for Zylith's four ZK circuits. Each subdirectory is an independent Scarb project generated by the [Garaga](https://github.com/keep-starknet-strange/garaga) CLI.

## Verifiers

| Project | Circuit | Public Inputs |
|---------|---------|---------------|
| `membership_verifier/` | Merkle membership proof | root, nullifierHash |
| `swap_verifier/` | Shielded swap | changeCommitment, root, nullifierHash, newCommitment, tokenIn, tokenOut, amountIn, amountOutMin |
| `mint_verifier/` | Shielded liquidity mint | changeCommitment0, changeCommitment1, root, nullifierHash0, nullifierHash1, positionCommitment, tickLower, tickUpper |
| `burn_verifier/` | Shielded liquidity burn | root, positionNullifierHash, newCommitment0, newCommitment1, tickLower, tickUpper |

## Tooling Requirements

These projects require **different tooling versions** than the main Zylith project:

| Tool | Main Project | Garaga Verifiers |
|------|-------------|-----------------|
| Scarb | 2.15.1 | **2.14.0** |
| snforge | 0.55.0 | 0.55.0 |

The `.tool-versions` file at this directory root ensures `asdf` picks the correct versions automatically.

```bash
# Install required scarb version
asdf install scarb 2.14.0
```

## Regenerating Verifiers

If you update a circuit's trusted setup (new `.zkey` / verification key), regenerate the corresponding verifier:

```bash
# Requires: pip install garaga
garaga gen --system groth16 \
  --vk circuits/build/<circuit>/<circuit>_vk.json \
  --project-name <circuit>_verifier

# Example:
garaga gen --system groth16 \
  --vk circuits/build/membership/membership_vk.json \
  --project-name membership_verifier
```

The generated project will be placed in the current directory. Move it into `garaga_verifiers/` if needed.

## Building & Testing

```bash
cd garaga_verifiers/<verifier_name>

# Build
scarb build

# Run fork tests (requires SEPOLIA RPC in Scarb.toml)
snforge test
```

## Interface

All verifiers expose the same function signature:

```cairo
fn verify_groth16_proof_bn254(proof_calldata: Span<felt252>) -> Result<Span<u256>, felt252>
```

On success, returns the verified public inputs as `Span<u256>`. The main `VerifierCoordinator` contract calls these verifiers via dispatcher.

## License

MIT
